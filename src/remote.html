<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      #remote-buttons button {
        width: 100%;
      }

      #remote-buttons td {
        margin: 30px 15px;
      }

      .address-form {
        margin: 20px 10px;
      }
    </style>
    <title>Roku Remote</title>
  </head>
  <body>
    <table id="remote-buttons">
      <tr>
        <td>
          <button id="${BACK}">Back</button>
        </td>
        <td></td>
        <td>
          <button id="${HOME}">Home</button>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <button id="${UP}">Up</button>
        </td>
        <td></td>
      </tr>
      <tr>
        <td>
          <button id="${LEFT}">Left</button>
        </td>
        <td>
          <button id="${OK}">OK</button>
        </td>
        <td>
          <button id="${RIGHT}">Right</button>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <button id="${DOWN}">Down</button>
        </td>
        <td></td>
      </tr>
      <tr>
        <td>
          <button id="${INSTANT_REPLAY}">Replay</button>
        </td>
        <td></td>
        <td>
          <button id="${INFO}">Info</button>
        </td>
      </tr>
      <tr>
        <td>
          <button id="${REV}">REV</button>
        </td>
        <td>
          <button id="${PLAY}">Play</button>
        </td>
        <td>
          <button id="${FWD}">FWD</button>
        </td>
      </tr>
      <tr>
          <td colspan="2">
            <input id="send-text-input" type="text"/>
          </td>
          <td>
            <button id="send-text-button">Send</button>
          </td>
        </tr>
    </table>
    <div class="address-form">
      <label for="ip">IP Address:</label>
      <input type="text" name="ip" id="ip">
      <button id="set-address-button">OK</button>
    </div>
	  <script>
      const vscode = acquireVsCodeApi();
      const remoteButtons = document.getElementById('remote-buttons');
      const sendTextInput = document.getElementById('send-text-input');
      const sendTextButton = document.getElementById('send-text-button');
      const ipAddressText = document.getElementById('ip');
      const setIpAddressButton = document.getElementById('set-address-button');

      function onClick (e) {
        vscode.postMessage({action: 'REMOTE_ACTION', payload: e.target.id});
      }

      function onKeyDown (e) {
        e.stopPropagation();
        vscode.postMessage({action: 'REMOTE_ACTION', payload: e.code});
      }

      function onSendTextButtonClick (e) {
        e.stopPropagation();
        if (sendTextInput.value !== '') {
          vscode.postMessage({action: 'SEND_TEXT', payload: sendTextInput.value});
          sendTextInput.value = '';
        }
      }

      function onSendTextKeyDown (e) {
        e.stopPropagation();
        if (e.code === '${OK}') {
          vscode.postMessage({action: 'SEND_TEXT', payload: e.target.value});
          e.target.value = '';
        }
      }

      function onSetIpAdrressButtonClick (e) {
        vscode.postMessage({ action: 'SET_IP_ADDRESS', payload: ipAddressText.value });
        ipAddressText.value = '';
      }

      function onIpAddressTextKeyDown (e) {
        e.stopPropagation();
        if (e.code === '${OK}') {
          vscode.postMessage({ action: 'SET_IP_ADDRESS', payload: e.target.value});
          e.target.value = '';
        }
      }

      remoteButtons.addEventListener('click', onClick);
      sendTextInput.addEventListener('keydown', onSendTextKeyDown);
      sendTextButton.addEventListener('click', onSendTextButtonClick);
      setIpAddressButton.addEventListener('click', onSetIpAdrressButtonClick);
      ipAddressText.addEventListener('keydown', onIpAddressTextKeyDown);
      document.addEventListener('keydown', onKeyDown);
    </script>
  </body>
</html>